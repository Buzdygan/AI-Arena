\documentclass[licencjacka]{pracamgr}

\usepackage{polski}
\usepackage[latin2]{inputenc}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{hyperref}

\author{Jakub Tla³ka}
\nralbumu{292665}
%\author{Micha³ Kawiak}
%\nralbumu{277558}
%\author{Szymon Majewski}
%\nralbumu{277556}
%\author{Karol ¯ebrowski}
%\nralbumu{277580}

\title{Implementacja systemu AI-Arena}
\tytulang{Implementation of AI-Arena system}

\kierunek{Informatyka}

\opiekun{dra. Janusza Jab³onowskiego\\
  Wydzia{\l} Matematyki Informatyki i Mechaniki\\
  }
  
\date{Maj 2012}

\dziedzina{ 
11.3 Informatyka\\ 
}


\klasyfikacja{D. Software \\
D.0. General\\}


\keywords{programy walczace, arena, sztuczna inteligencja}
 
\newtheorem{defi}{Definicja}[section]

\begin{document}
\maketitle

\begin{abstract}
W pracy przedstawiono implementacje systemu AI-Arena,
System AI-Arena s³u¿y do przeprowadzania rozgrywek i turniejów ró¿nych gier pomiêdzy programami komputerowymi.
System ma w zamierzeniu twórców s³u¿yæ osobom zainteresowanym sztuczn± inteligencj± do sprawdzenia swoich umiejêtno¶ci,
lub jako pomoc przy badaniach nad sztuczn± inteligencj±.
\end{abstract}

\tableofcontents

\chapter{Wprowadzenie}

    Serwis AI-Arena to uniwersalna platforma do organizowania konkursów algorytmicznych. G³ówn± domen± tych konkursów
    jest dziedzina sztucznej inteligencji, w szczególno¶ci inteligentnych programów walcz±cych, ale pozwala równie¿
    na organizacjê konkursów algorytmicznych, w³±cznie z zadaniami interaktywnymi, co sprawia, ¿e istnieje
    pe³na dowolno¶æ wyboru rodzaju konkursu.
    Od parudziesiêciu lat odbywaj± siê zawody, maj±ce na celu wy³oniæ programy najlepiej graj±ce w popularne gry,
    takie jak szachy, warcaby itp. Serwis AI-Arena pozwala organizowaæ takie konkursy dla dowolnej gry wieloosobowej.
    Dodatkow± zalet± jest istnienie rankingu sta³ego. W ten sposób mo¿na na bie¿±co sprawdzaæ dzia³anie
    w³asnych programów i mierzyæ siê z najlepszymi dotychczasowymi zawodnikami. Serwis mo¿e mieæ zastosowania
    zarówno w nauce jak i w biznesie, ze wzglêdu na rosn±ce zapotrzebowanie na inteligentne programy
    rozwi±zuj±ce problemy w warunkach rywalizacji takich jak np gie³da. Twórcy serwisu licz± na to,
    ¿e wraz ze wzrostem jego popularno¶ci, AI-Arena skupi spo³eczno¶æ ludzi zafascynowanych dziedzin±
    sztucznej inteligencji i przyczyni siê do rozwoju tej ga³êzi nauki.
    Projekt jest udostêpniony w serwisie \href{http://github.com/Buzdygan/ai-arena}{Github}. 
    Ka¿da osoba chêtna do pomocy przy jego rozwoju mo¿e uzyskaæ prawa zapisu, wystarczy skontaktowaæ
    siê z twórcami i poprosiæ o dostêp.


\chapter{Metodologia Pracy}
	Aby usprawniæ proces tworzenia systemu AI-Arena, postanowili¶my na pocz±tku prac nad systemem wybraæ odpowiedni± do naszych potrzeb metodologiê pracy. Pocz±tkowo rozwa¿ali¶my nastêpuj±ce metodologie: Agile Uniformed Process, Extreme Programming, Scrum. Przy dokonywaniu wyboru kierowali¶my siê nastêpuj±cymi kryteriami:
	\begin{itemize}
	\item Poniewa¿ pracowali¶my w zespole czteroosobowym, wybrana metodyka powinna byæ metodyk± lekk±.
	\item Poniewa¿ spotykali¶my siê co tydzieñ na proseminarium, chciel¶my aby podstawow± jednostk± pracy by³y tygodniowe iteracje.
	\item Poniewa¿ w trakcie tworzenia projektu wszyscy cz³onkowie zespo³u kontynuowali studia i musieli wype³niaæ zwi±zane z tym obowi±zki, chcieli¶my aby ka¿dy z cz³onków móg³ samodzielnie podj±æ decyzjê o ilo¶ci pracy jak± wykona w najbli¿szym tygodniu.
	\item Praca nad projektem mia³a przebiegaæ w sposób rozproszony. Chcieli¶my mieæ mo¿liwo¶æ pracy w dogodnych dla siebie godzinach, niezale¿nie od pozosta³ych cz³onków zespo³u.
	\item Wybrana przez nas metodyka powinna równie¿ pozwala¼ na ³atwe ¶ledzenie zmian w projekcie, oraz u³atwiaæ zapewnianie kontroli jako¶ci.
	\end{itemize}
	
    ¯adna z pocz±tkowo rozwa¿anych metodologii nie spe³nia³a wszystkich naszych wymagañ. Zdecydowali¶my siê wiêc na   modyfikacjê metodologii Scrum.
    Jest to metodologia typu lekkiego. Dzieli okres pracy na krótsze podokresy nazywane sprintami.
    Podczas ka¿dego takiego sprintu, realizowana jest skoñczona czê¶æ funkcjonalno¶ci.
    Sprinty nie powinny trwaæ d³u¿ej ni¿ dwa, trzy tygodnie. W naszym przypadku by³ to tydzieñ
    miêdzy kolejnymi spotkaniami na zajêciach z prowadz±cym. Podczas takich zajêæ, ustalany
    by³ zakres pracy przydzielony poszczególnym osobom na przysz³y tydzieñ, oraz weryfikowana
    by³a praca wykonana w tygodniu poprzednim. Prowadz±cy zg³asza³ uwagi do niektórych funkcjonalno¶ci.
    Dyskutowane by³y równie¿ dokumenty powstaj±ce przy okazji pracy nad projektem, przede wszystkim
    poni¿sza praca licencjacka. Zapis przebiegu zajêæ, wraz z celami na przysz³y tydzieñ, nazywany
    by³ minutkami i trzymany w Google Documents, tak by ka¿dy z cz³onków zespo³u oraz prowadz±cy
    zajêcia mia³ do niego dostêp.\\
    Dodatkowo organizowane by³y spotkania samego zespo³u. Odbywa³y siê one równie¿ raz w tygodniu
    i mia³y na celu kontrolowanie przebieg prac i zadbanie o to by zosta³y wykonane zaplanowane
    zadania. Spotkania odbywa³y siê w budynku Wydzia³u Matematyki Informatyki i Mechaniki UW, b±d¼ jako konferencje video z wykorzystaniem Google Hangouts.
    Ich przebieg nadzorowa³ Lider Projektu, który by³ odpowiedzialny równie¿ za realizowanie
    za³o¿eñ przyjêtej metodologii pracy.\\
    Podzia³ obowi±zków miêdzy cz³onków zespo³u by³ wynikiem porozumienia miêdzy cz³onkami i by³
    zatwierdzany przez lidera projektu, a nastêpnie przedstawiany prowadz±cemu zajêæ.\\
    Do bie¿±cej kontroli stanu projektu u¿yty zosta³ system Redmine. Umo¿liwia on tworzenie
    zadañ i przydzielanie ich cz³onkom zespo³u. Ka¿de zadanie ma status, który zawiera siê w zbiorze
    (otwarte, przydzielone, zrealizowane, zamkniête). Stan otwarty oznacza, ¿e zadanie nie jest
    jeszcze przydzielone konkretnej osobie. Stan przydzielone oznacza, ¿e zadanie jest przydzielona,
    a osoba odpowiedzialna za jego wykonanie jest w trakcie jego realizacji. Stan zrealizowane
    oznacza, ¿e zadanie zosta³o wykonane przez osobê odpowiedzialn±, ale nie zosta³o jeszcze
    zweryfikowane pod k±tem poprawno¶ci. Stan zamkniête oznacza, ¿e zadanie zosta³o zrealizowane
    i zweryfikowane.\\
    Kod projektu, oraz dokumenty takie jak praca licencjacka, zosta³y umieszczone w repozytorium Gita.
    Git to system kontroli wersji dbaj±cy o archiwizacjê kodu oraz koordynacjê równoleg³ych zmian
    wszystkich cz³onków zespo³u. Repozytorium jest publiczne i dostêpne online w serwisie GitHub.
    Wszystkie zmiany dokonywane przez cz³onków zespo³u s± archiwizowane, tak by mo¿na je by³o
    odtworzyæ. Mo¿liwe jest równie¿ jednoczesne rozwijanie projektu w kilku niezale¿nych kierunkach,
    a nastêpnie po³±czenie efektów pracy.\\

\chapter{Podstawowe pojêcia}

\section{Gra}
    
    Gra sk³ada siê z Regu³ i Sêdziego. \\
    Regu³y okre¶laj± stan pocz±tkowy, dostêpne graczom ruchy oraz warunki zwyciêstwa, przegranej, b±d¼ remisu. \\
    Powinny ¶ci¶le okre¶laæ Protokó³ Komunikacji miêdzy Programami Walcz±cymi, a Sêdzi±.
    Gra powinna byæ co najmniej dwuosobowa. \\
    W warunkach serwisu AI-Arena graczami bêd± najczê¶ciej programy komputerowe,
    nazywane Botami b±d¼ Programami Walcz±cymi. \\
    Sêdzia to program kontroluj±cy przebieg rozgrywki. Ma za zadanie:
    \begin{itemize}
    \item wyznaczyæ stan pocz±tkowy ka¿dej rozgrywki 
    \item Odbieraæ komunikaty od programów graj±cych, sygnalizujace ich zagrania
    \item Kontrolowaæ poprawno¶æ zagrañ graczy, oraz uaktualniaæ stan rozgrywki
    \item Informowaæ Graczy o obecnym stanie rozgrywki
    \item Rozstrzygaæ czy gra siê zakoñczy³a i przydzielaæ punkty zwyciêstwa graczom.
    \end{itemize}

\section{Program Walcz±cy - Bot}

    Jest to program napisany w jednym z obs³ugiwanych przez serwis jêzyków.
    Musi byæ przypisany do konkretnej Gry dostêpnej w serwisie.
    Uczestniczy w rozgrywkach (Meczach) z innymi botami przypisanymi do tej Gry.
    Ma za zadanie przetwarzaæ informacje o dotychczasowym przebiegu rozgrywki
    i produkowaæ kolejne posuniêcia, zgodne z regu³ami Gry.

\section{Sêdzia}

    Jest to program zwi±zany z dan± Gr±. Ma on za zadanie kontrolowaæ przebieg Meczu,
    weryfikowaæ zagrywki graczy, informowaæ ich o aktualnym stanie, oraz ustalaæ wynik Meczu,
    zgodnie z zasadami zwi±zanymi z Gr±, opisanymi w Regu³ach.
    Kod sêdziego jest publiczny i dostêpny wszystkim graczom.

\section{Regu³y}
    Dokument udostêpniany publicznie, opisuj±cy zasady gry, oraz protokó³ formatu komunikatów
    przesy³anych miêdzy Botami a Sêdzi±. Powinien byæ zgodny z implementacj± programu
    Sêdziego, oraz zapewniaæ mo¿liwo¶æ przeprowadzenia dowolnej rozgrywki w obrêbie
    zasad Gry.

\section{Mecz/Rozgrywka}
    Jest rozgrywany miêdzy Botami, w obrêbie konkursu lub poza nim. Jego przebieg jest kontrolowany przez 
    Sêdziego. Za przesy³anie komunikatów miêdzy Botami, a Sêdzi±, oraz odebranie od Sêdziego rezultatu
    meczu odpowiedzialny jest Nadzorca.

\section{Nadzorca}
    Program bêd±cy integraln± czê¶ci± serwisu AI-Arena. Jego zadaniem jest uruchamianie programów Botów
    i Sêdziego podczas Meczu, a nastêpnie transportowanie miêdzy nimi komunikatów tekstowych zgodnych z ustalonym
    protoko³em. Nadzorca odbiera wynik Meczu od Sêdziego i przekazuje go Gearmanowi, w celu zapisania rezultatu w bazie.
    Dodatkowo Nadzorca kontroluje czas i pamiêæ zu¿ywan± przez Boty, tak by nie przekroczy³y dozwolonych limitów.
    Informacje o ich zu¿yciu wraz z logiem rozgrywki generowanym przez sêdziego, Nadzorca zwraca do Gearmana.

\section{Gearman}
    Zewnêtrzne narzêdzie kolejkowania zadañ i transportu danych. W AI-Arena s³u¿y jako pomost miêdzy Nadzorc±,
    a Baz± danych. Kolejkuje Mecze do rozegrania, zleca ich rozegranie Nadzorcy, a nastêpnie zapisuje do bazy
    przekazany przez Nadzorcê rezultat i dodatkowe informacje o przebiegu rozgrywki.

\section{Konkurs}

    Konkurs mo¿e mieæ okre¶lon± datê zakoñczenia, b±d¼ byæ tzw konkursem sta³ym, w którym nie ma ostatecznego
    terminu wysy³ania rozwi±zañ. Dla ka¿dego konkursu tworzony jest ranking, b±d¼ drabinka rozgrywek.
    Okre¶laj± one kolejno¶æ botów, w szczególno¶ci zwyciêzcê, b±d¼ aktualnego lidera konkursu.
    W przypadku konkursu sta³ego istnieje ranking, który jest posortowany po sumie zdobytych przez bota
    punktów w meczach, przy czym ka¿dy bot powinien mieæ tê sam± liczbê rozegranych meczy.

    
\chapter{Zastosowania w nauce i biznesie}

    Sztuczna inteligencja jest jedn± z szybciej rozwijaj±cych siê obecnie dziedzin.
    Zastosowania algorytmów SI siêgaj± prawie wszystkich obszarów nie tylko
    internetu, ale i codziennego ¿ycia. Serwis AI-Arena pomaga rozwijaæ ga³±¼ tej nauki
    zwi±zan± z rywalizacj±.\\

    Najprostsze przyk³ady rywalizacji to oczywi¶cie wszelkiego
    rodzaju gry i sporty. Obecnie komputery s± w stanie wygrywaæ z cz³owiekiem w
    wiêkszo¶ci gier takich jak szachy, warcaby itp. Warto wspomnieæ mecz szachowy mistrza ¶wiata
    Garriego Kasparowa z komputerem Deep Blue czy teleturniej Va Banque z udzia³em komputera Watson
    - w obu przypadkach zwyciê¿y³a sztuczna inteligencja
    (\url{http://www.benchmark.pl/aktualnosci/Superkomputer_IBM_wystapil_w_teleturnieju-32781.html}).
    Coraz bardziej zaawansowani staj± siê przeciwnicy kierowani przez
    komputer w grach video. Równie¿ w sporcie zaczêto doceniaæ znaczenie metod naukowych
    do opracowywania optymalnych strategii. Z powodzeniem wykorzystuje siê komputer do badania
    statystyk w amerykañskiej lidze baseballowej
    (\url{http://research.sabr.org/journals/online/38-brj-1976/165-computers-in-baseball-analysis}).
    Prawdopodobnie kwesti± czasu jest analizowanie
    gry wirtualnych zespo³ów kierowanych sztuczn± inteligencj±, a nastêpnie wykorzystywanie
    obserwacji do poprawy gry prawdziwej dru¿yny.\\

    Rywalizacja mo¿e byæ wykorzystana równie¿ jako metoda rozwi±zywania problemów.
    Przyk³adem takiego podej¶cia s± algorytmy genetyczne, w których najlepsze jednostki
    pozostaj± w obiegu, ca³y czas udoskanalaj±c swoje podej¶cie do rozwi±zywania danego problemu.\\
    
    Serwis AI-Arena ma du¿e zastosowanie w biznesie. Firmy nieustannie rywalizuj± miêdzy sob± w walce
    o klienta. Serwis umo¿liwia symulowanie takiej rywalizacji i dziêki temu odkrywanie skutecznych
    algorytmów sztucznej inteligencji, które bêd± podejmowa³y decyzje decyduj±ce o sukcesie
    wykorzystuj±cej je firmy. Mo¿na tak¿e symulowaæ inwestowanie funduszy np. na gie³dzie.
    Banki wykorzystuj± sztuczn± inteligencjê do organizacji operacji finansowych i zarz±dzania ¶rodkami.
    Sztuczna inteligencja odnosi ju¿ sukcesy w rywalizacji z lud¼mi w symulacji obrotów finansowych
    (\url{http://news.bbc.co.uk/2/hi/business/1481339.stm}).\\

    Innym przyk³adem zastosowania AI-Arena s± dzia³ania wojenne. Serwis mo¿e pomóæ w szukaniu
    algorytmów, które bêd± potrafi³y adaptowaæ siê do ró¿nych warunków i w zale¿no¶ci od nich
    sugerowaæ najlepsze strategie i taktyki w walce z przeciwnikiem.

\chapter{Podobne platformy}

Obecnie istniej± serwisy internetowe podobne do AI-Arena. Oto kilka z nich:

\section{Top Coder}

    Bardzo popularny serwis organizuj±cy ró¿nego rodzaju konkursy programistyczne.
    Jednym z nich s± tzw Marathon Matche, podczas których uczestnicy wysy³aj±
    programy, które staraj± siê najbardziej optymalnie rozwi±zaæ dany problem, przy czym
    nie istnieje rozwi±zanie ca³kowicie optymalne.

\section{Ai Challenge}

    Serwis organizuj±cy w sposób cykliczny zawody dla programów walcz±cych. Najczê¶ciej
    ok 2 konkursy rocznie. Ka¿dy konkurs ma okre¶lony czas trwania i nie mo¿na w nim
    uczestniczyæ po jego zakoñczeniu.

\section{SIO}

    Projekt od lat wykorzystywany do organizowania konkursów algorytmicznych, w szczególno¶ci
    polskiej Olimpiady Informatycznej, ale te¿ Miêdzynarodowej Olimpiady Informatycznej.
    Jest to framework, który mo¿na wykorzystywaæ równie¿ w wersji lokalnej, nie tylko
    jako serwis internetowy. 

\section{SPOJ}

    Serwis zawieraj±cy du¿± bazê zadañ algorytmicznych dostêpnych do rozwi±zywania u¿ytkownikom.
    Zadania nie maj± okre¶lonego terminu rozwi±zywania. Istnieje ranking bior±cy pod uwagê
    liczbê wszystkich rozwi±zanych przez u¿ytkowników zadañ.

\section{MAIN}
    
    Posiada du¿± bazê zadañ z olimpiad informatycznych, ale tak¿e kursy
    umo¿liwiaj±ce pog³êbienie wiedzy algorytmicznej.


\section{Tabela porównuj±ca serwisy}

\footnotesize
\begin{tabular}{|c|c|c|c|}
\hline
       & tematyka & typ konkursów & baza zadañ \\ \hline
Top Coder & algorytmy, problemy optymalizacyjne & okresowe & bardzo du¿a baza z przesz³ych zawodów \\ \hline
Ai Challenge & programy walcz±ce & okresowe & konkurs co pó³ roku \\ \hline
SPOJ & algorytmika & sta³e/okresowe & du¿a baza zadañ \\ \hline
AI-Arena & programy walcz±ce & sta³e/okresowe & baza gier moderowana przez u¿ytkowników \\ \hline
SIO & algorytmy & okresowe & wiêkszo¶æ zadañ dostêpna tylko podczas zawodów \\ \hline
MAIN & algorytmy & sta³e & zadania z najwa¿niejszych zawodów informatycznych \\ \hline
\end{tabular}

\chapter{Architektura systemu}

Na serwis AI-Arena sk³adaj± siê trzy wartwy: nadzorcy, schedulera i serwisu webowego.

\section{Nadzorca}
Nadzorca jest j±drem serwisu AI-Arena.
Warstwa nadzorcy jest odpowiedzialna za uruchamianie rozgrywek pomiêdzy wybranymi graczami,
zbieranie informacji o ich wynikach i przekazywnie ich do warstwy schedulera.
Nadzorca jest skryptem napisanym w pythonie, którego najwa¿niejsz± czê¶ci± jest metoda play.
Metoda ta przyjmuje jako argumenty uruchamialne pliki sêdziego i programów graj±cych, oraz limity czasowy i pamiêciowy dla ka¿dego programu graj±cego.
Nastêpnie metoda play przeprowadza odpowiedni± rozgrywkê, zwracaj±c jako wynik s³ownik zawieraj±cy:
\begin{itemize}
    \item Ci±g liczb oznaczaj±cy przydzielone przez sedziego punkty za rozgrywkê
    \item Informacje na temat przebiegu rozgrywki
    \item Czas jaki zu¿y³y programy walcz±ce
    \item Pamiêæ RAM jak± wykorzystywa³y programy walcz±ce
\end{itemize}

Rozgrywka zaczyna siê przez uruchomienie programów walcz±cych, oraz sêdziego, kontroluj±cego przebieg rozgrywki.
Komunikacja miêdzy sêdzi± a poszczególnymi programami odbywa siê za po¶rednictwem nadzorcy, który odczytuje
komunikaty ze standardowego wyj¶cia programów i wypisuje informacje zwrotne na ich standardowe wej¶cie.
Format komunikatów od sêdziego i botów powinien byæ wyspecyfikowany dla ka¿dej gry, przy czym powinien on
byæ zgodny z poni¿szym protoko³em:\\
\begin{itemize}
    \item Bot wysy³a komunikaty TYLKO do sêdziego (za po¶rednictwem Nadzorcy)
    \item Ka¿dy komunikat od Sêdziego musi byæ potwierdzony komunikatem zwrotnym od Bota.
    \item Komunikaty wysy³ane przez sêdziego maj± nastêpuj±cy format: zaczynaj± siê od nawiasów kwadratowych,
          w ktorych znajduje siê lista garczy oddzielona przecinkami. Nastêpnie znajduje siê wiadomo¶æ,
          która zostanie przekazana odpowiednim botom. Komunikat musi koñczy siê ci±giem '<<<' i znakiem
          nowej linii, n.p: '[1,2,3,4,5]INIT<<<newline'.
    \item Sêdzia otrzymuje komunikaty zwrotne od botów w takiej kolejno¶ci w jakiej zostali wylistowani.
    \item Zak³ada siê ¿e ci±g '<<<newline' koñczy komunikat. Wys³anie komunikatu o nieprawid³owym formacie skutkuje zakoñczeniem rozgrywki.
    \item Komunikaty od nadzorcy do botów i do sêdziego równie¿ koñcz± siê ci±giem znaków '<<<newline'.
          Dziêki temu mo¿na przesy³aæ komunikaty wielowierszowe.
    \item Je¶li Sêdzia chce wys³aæ komunikat do wszystkich mo¿e zacz±æ ALBO od wylistowania wszystkich graczy,
          ALBO u¿yæ skrótu notacyjnego: '[0]' - to jeszcze nie dzia³a, kewstia dopisania jednego if'a
    \item Ponadto, je¶li Sêdzia stwierdzi³, ¿e gra siê zakoñczy³a i chce poinformowaæ wszystkich o tym,
          ¿e nast±pi³ koniec gry wysy³a do Nadzorcy komunikat o tre¶ci "[0]END<<<newline".
          Nastêpnie powinien wys³aæ komunikat zawieraj±cy punktacjê dla wszystkich graczy w postaci: '[score1, score2, ... ]<<<newline'.
    \item Je¶li sêdzia chce zakoñczyæ dzia³anie którego¶ z graczy nale¿y wys³aæ do niego wiadomo¶æ KILL (np. "[4]KILL<<<newline").
          Mo¿na te¿ w ten sposób zabiæ wiêksz± liczbê graczy lub nawet wszystkich ("[0]KILL<<<newline")
    \item Je¶li sêdzia wy¶le komunikat do bota który odszed³ w pokoju, dostanie komunikat zwrotny '\_DEAD\_<<<newline'.
          Boty powinny unikaæ wysy³ania tego komunikatu, gdy¿ mog± zostaæ uznane za martwe.
\end{itemize}


\section{Scheduler}
\begin{wrapfigure}{r}{0.4\textwidth}
	\begin{center}
		\includegraphics[width=0.38\textwidth]{img/gearman_stack.png}
	\end{center}
    \vspace{-25pt}
	\caption{Aplikacja Gearmana}
    \vspace{-10pt}
	\begin{center}
		\includegraphics[width=0.38\textwidth]{img/gearman_cluster.png}
	\end{center}
    \vspace{-25pt}
	\caption{Klaster Gearmana}
    \vspace{-10pt}
\end{wrapfigure}
Do realizacji warstwy Schedulera u¿ywany jest program Gearmand0.26. Gearman jest lekkim frameworkiem s³u¿±cym do
przydzielania zadañ do wykonania okre¶lonym maszynom lub procesom. Posiada prosty interfejs i jest ³atwy w u¿yciu.
Ka¿da aplikacja korzystaj±ca z tego frameworku sk³ada siê z trzech czê¶ci: klienta, workera oraz serwera. Rolê
klienta pe³ni czê¶æ webowa serwisu, która zleca rozegranie odpowiedniej Rozgrywki, podaj±c jako argumenty grê,
boty i sêdziego Rozgrywki. To zadanie jest zg³aszane do serwera, który je kolejkuje oraz przydziela workerowi.
Zadanie workera ogranicza siê do uruchomienia nadzorcy z odpowiednimi parametrami, a po zakoñczeniu Rozgrywki
zapisaniu wyników do bazy danych.

Warstwa Schedulera umo¿liwia zakolejkowanie kilku Meczy do rozegrania np. w razie
du¿ego ruchu w serwisie lub gdy wymaga tego organizacja Turnieju, oraz wykonanie tych zadañ w sposób asynchroniczny.
Gearman ³±czy czê¶æ webow± serwisu z nadzorc±, przez co obie czê¶ci funkcjonuj± i mog± byæ rozwijane niezale¿nie.
Umo¿liwia tak¿e u¿ycie wielu klientów, serwerów i workerów tworz±cych klaster. U¿ycie zapasowego serwera
pomog³oby ustabilizowaæ pracê serwisu, a uruchomienie kilku workerów na wielordzeniowej maszynie znacznie j± przyspieszyæ.

\section{Serwis webowy}
U¿ytkownik komunikuje siê z systemem poprzez interfejs webowy, zaimplementowany w Django.
Interfejs udostêpnie nastêpuj±ce akcje:
\begin{itemize}
    \item Za³o¿enie konta
    \item Dodanie nowej gry do serwisu
    \item Wys³anie w³asnego programu walcz±cego w wybran± grê dostêpn± w serwisie
    \item Uruchomienie testowego meczu, miêdzy w³asnym programem, a innym wybranym programem,
          zg³oszonym do tej samej gry.
    \item Zg³oszenie programu walcz±cego do konkursu, gdzie bêdzie on rywalizowa³ z pozosta³ymi
          zg³oszonymi programami.
    \item Przegl±danie zapisów rozgrywek.
    \item Przegl±danie aktualnego rankingu konkursu.
    \item Zapoznanie siê z zasadami wybranego konkursu/gry
    \item Obejrzenie kodu ¼ród³owego programu sêdziego, dla danej gry.
\end{itemize}

\section{Baza danych}
Za obs³ugê bazy danych odpowiedzialny jest framework Django. Wspó³pracuje z bazami:
PostgreSQL, MySQL, SQLite, Microsoft SQL Server oraz Oracle. Domy¶ln± baz±, na której dzia³a serwis
jest PostgreSQL, ale nie jest to wymagane. Tabele w bazie danych s± tworzone przez Django w sposób automatyczny
na podstawie modeli w pliku models.py, ka¿demu modelowi odpowiada jedna tabela w bazie.
Oprócz tego istnieje plik fixture, do którego mo¿na zapisaæ lub wczytaæ z niego dane znajduj±ce siê w bazie.
S³u¿y on do tworzenia testowej bazy danych.

W serwisie s± u¿yte nastêpuj±ce modele(wraz z najwa¿niejszymi polami):
\vspace{20pt}\\*
{\large Game}
\begin{itemize}
    \item nazwa
    \item ¶cie¿ka do programu sêdziego
    \item plik z zasadami
\end{itemize}
{\large Bot}
\begin{itemize}
    \item nazwa
    \item w³a¶ciciel
    \item plik ¼ród³owy
\end{itemize}
{\large Ranking}
\begin{itemize}
    \item typ rankingu - od niego zale¿y w jaki spposób bêdzie rozgrywany konkurs
\end{itemize}
{\large BotRanking - przechowuje opis pozycji Bota w danym Rankingu}\\*
{\large Contest}
\begin{itemize}
    \item nazwa
    \item Gra
    \item Ranking
    \item zawodnicy - Boty, które bior± udzia³ w konkursie
\end{itemize}
{\large Match}
\begin{itemize}
    \item Bot
    \item wynik
    \item wykorzystany czas
    \item zu¿yta pamiêæ
\end{itemize}
{\large MatchBotResult - zawiera rezultat Bota w pojedynczym Meczu}
\begin{itemize}
    \item Game
    \item Contest
    \item wyniki uczestnicz±cych Botów
\end{itemize}
{\large UserProfile}
\begin{itemize}
    \item User
    \item podstawowe dane: zdjêcie, pañstwo itp.
\end{itemize}
{\large UserNews}\\*
{\large GameComment - komentarz do Gry}\\*
{\large ContestComment - komentarz do Konkursu}\\*
%\begin{tabular}{|c|c|}
%\hline
%Game & nazwa, scie¿ka do programu sêdziego, plik z zasadami \\ \hline
%Bot & w³a¶ciciel, Gra \\ \hline
%\end{tabular}

\chapter{Dokumentacja u¿ytkowa i opis implementacji}

\section{Scenariusze u¿ycia systemu}
\begin{figure}[ht!]
	\begin{center}
		\resizebox{!}{22cm}{
			\includegraphics[angle=90]{img/UseCaseDiagram.jpg}
		}
		\caption{Diagram przypadków u¿ycia}
	\end{center}
\end{figure}

\Large{\subsection{Z udzia³em u¿ytkownika niezalogowanego (Go¶cia)}} 
U¿ytkownik niezalogowany ma bardzo ograniczone prawa u¿ywania serwisu. Praktycznie jedyn± dozwolon± aktywno¶ci± jest rejestracja
w serwisie lub próba zalogowania siê do utworzonego wcze¶niej konta.

\subsubsection{Rejestracja w systemie}
\begin{wrapfigure}{r}{0.5\textwidth}
	\begin{center}
		\includegraphics[width=0.48\textwidth]{img/register.png}
	\end{center}
	\caption{Pasek logowania i rejestracji do serwisu}
\end{wrapfigure}
Aby zarejestrowaæ siê w systemie nale¿y wykonaæ kilka kroków. Na pocz±tku nale¿y klikn±æ w napis "Register" zlokalizowany po prawej stronie 
na górze.

Nastêpnie system przekieruje u¿ytkownika do strony, gdzie bêdzie móg³ wybraæ swój login oraz has³o. Nale¿y zwróciæ uwagê, i¿ login
musi byæ unikalny, mo¿e zawieraæ wy³±cznie ma³e i du¿e litery, cyfry oraz znak '\_'. W przeciwnym wypadku pojawi siê komunikat o b³êdzie.

Po prawid³owym wykonaniu tego kroku u¼ytkownik zostanie przeniesiony na swoj± stronê profilow±. Mo¿e st±d zarz±dzaæ swoim kontem. 
Od tej chwili jest równie¿ zalogowany w serwisie, co znaczy, ¿e mo¿e m. in. wysy³aæ swoje boty do gier lub wykonywaæ inne akcje dostêpne
wy³±cznie dla zalogowanych u¿ytkowników.

\subsubsection{Logowanie}
Logowanie jest standardow± aktywno¶ci±. któr± siê spotyka na wszystkich forach i wielu serwisach. Przycisk logowania znajduje siê tu¿ obok 
przycisku rejestracji. Aby siê zalogowaæ nale¿y klikn±æ w ten przycisk a nastêpnie wype³niæ pola formularza, który siê pojawi na ekranie.
Je¶li dane bêd± zgodne z tymi zapisanymi w bazie danych, system przekieruje u¿ytkownika na jego stronê profilow±.

\Large{\subsection{Z udzia³em u¿ytkownika zalogowanego}}

\subsubsection{Wylogowanie siê z serwisu}
\begin{wrapfigure}{l}{0.5\textwidth}
	\begin{center}
		\includegraphics[width=0.48\textwidth]{img/logout.png}
	\end{center}
	\caption{Pasek wylogowania z serwisu}
\end{wrapfigure}
Wylogowanie jest kolejn± standardow± aktywno¶ci± udostêpnian± przez wiele serwisów. Aby wylogowaæ siê z serwisu nale¿y klikn±æ przycisk "Logout", 
który znajduje siê w prawym, górnym roku strony. Zastêpuje on przycisk "Login", który widoczny jest dla niezalogowanych u¿ytkowników. Po klikniêciu tego przycisku
u¿ytkownik jest przekierowywany na stronê g³ówn± serwisu.

\subsubsection{Otwarcie swojej strony profilowej}
Aby otworzyæ swoj± stronê profilow± u¿ytkownik musi klikn±æ w link znajduj±cy siê pod jego loginem. Loginy u¿ytkownika pojawiaj± siê w ró¿nych miejscach systemu
i klikniêcie w dowolny z nich powoduje otwarcie strony profilowej danego u¿ytkownika. W szczególno¶ci po klikniêciu na w³asny login pojawi siê w³asna strona u¿ytkownika.
Isnieje równie¿ tzw. "sta³y link do profilu" znajduj±cy siê na górze strony w prawym rogu. Po klikniêciu w znajduj±cy siê tam login u¿ytkownika (zaznaczonego innym kolorem
ni¿ reszta napisu) system wy¶wietla stronê profilow± aktualnie zalogowanego u¿ytkownika.

\subsubsection{Edycja profilu u¿ytkownika}
Gdy u¿ytkownik znajduje siê na swojej stronie profilowej ma dostêp do kilku odno¶ników. Jednym z nich jest odno¶nik do strony konfiguracyjnej profilu. Aby j± otworzyæ nale¿y klikn±æ 
w link "Edit profile" znajduj±cy siê pod zdjêciem profilowym. W oknie edycji profilu pojawia siê formularz zawieraj±cy kilka pól, m.in. zdjêcie, kraj, szko³a/uniwersytet czy zainteresowania. 
¯adne z nich nie jest obowi±zkowe. U¿ytkownik zatwierdza zmiany klikaj±c na prycisk "Update" znajduj±cy siê na samym dole fornularza.

\subsubsection{Utworzenie nowej gry lub konkursu}
\begin{wrapfigure}{l}{0.5\textwidth}
	\begin{center}
		\includegraphics[width=0.48\textwidth]{img/create_game.png}
	\end{center}
	\caption{Formularz do tworzenia nowej gry}
\end{wrapfigure}
Tworzenie gry (konkursu) jest jedn± z centralnych aktywno¶ci w serwisie. Aby utworzyæ grê, u¿ytkownik musi mieæ zawczasu przygotowane nastêpuj±ce pliki:
\begin{itemize}
	\item{Plik ¼ród³owy sêdziego.} 
	\item{Plik z zasadami rozgrywki} 
\end{itemize}

Sêdzia jest programem, który nadzowuje przebieg gry. Powinien byæ napisany w jednym z jêzyków: C, C++, Java, Python. Otrzymuje on komunikaty od Nadzorcy, który z kolei zczytuje je ze standardowego wej¶cia Botów. 
Sêdzia musi dokonaæ walidacji komunikatu, tj. upewniæ siê, i¿ format komunikatu jest zgodny z protoko³em opisanym w zasadach gry oraz, ¿e ruch zawarty w komunikacie nie narusza regu³ gry (przyk³adowo, ¿e
gracz graj±cy pionami czarnymi nie ruszy³ siê bia³ym pionem). Gdy upewni siê, ¿e otrzymany komunikat jest poprawny wysy³a na swoje standardowe wyj¶cie komunikat zgodnie z formatem opisanym w regu³ach gry.

Plik ¼ród³owy sêdziego jest dostêpny dla wszystkich zalogowanych u¿ytkowników serwisu. Ma to zapobiec wysy³aniu "stronniczych" sêdziów oraz ³atwieszemu ujawnieniu pewnych "ukrytych" wad protoko³u.
Administratorzy zastrzegaj± sobie prawo do usuniêcia lub poprawienia wadliwych sêdziów.

Plik z zasadami rozgrywki musi zawieraæ ogólny opis gry (np. fabu³ê wprowadzaj±c±) oraz szczegó³owy opis i znaczenie komunikatów. W szczególno¶ci musz± byæ zawarte informacje takie jak:
\begin{itemize}
	\item{dok³adny format komunikatu}
	\item{dozwolone odpowiedzi na ka¼dy rodzaj komunikatu}
	\item{komunikaty informuj±ce o b³êdzie}
\end{itemize}
Zosta³o przyjête za³o¿enie, ¿e Bot, który wy¶le komunikat o innej, ni¿ wyspecykowano formie automatycznie przegrywa dan± grê i jest zabijany przez Nadzorcê.

Aby utworzyæ konkurs nie jest potrzebne wcze¶niejsze przygotowywanie plików, jednak musi istnieæ gra, na bazie której chcemy utworzyæ nowy konkurs.
\begin{wrapfigure}{r}{0.7\textwidth}
	\begin{center}
		\includegraphics[width=0.68\textwidth]{img/game_details.png}
	\end{center}
	\caption{Szczegó³y gry}
\end{wrapfigure}
Gdy u¿ytkownik przygotowa³ ju¿ powy¿sze pliki powinien, w celu utworzenia nowej gry, klikn±æ w link "Create New Game" znajduj±cy siê na górnym pasku strony. Otworzy siê formularz zawieraj±cy pola, do których 
nale¿y wprowadziæ informacje nt. tworzonej gry (miêdzy innymi 2 wymienione wcze¶niej pliki czy nazwa gry). Warto zwróciæ uwagê, i¿ nazwa gry musi byæ unikalna, gdy¿ 
definiuje ona ¶cie¿kê do poszczególnych plików na dysku.
Gdy u¿ytkownik wype³ni formularz i zatwierdzi przyciskiem "Submit" na dole formularza zostanie przeniesiony na stronê zawieraj±c± detale w³a¶nie utworzonej gry.
Autor staje siê automatycznie moderatorem gry i ma prawo m. in. do edycji czy usuniêcia gry lub edycji i usuwania komentarzy u¿ytkowników.

\subsubsection{Wys³anie bota do gry lub kunkursu}
\begin{wrapfigure}{l}{0.6\textwidth}
	\begin{center}
		\includegraphics[width=0.48\textwidth]{img/send_bot.png}
	\end{center}
	\caption{Formularz do wysy³ania bota}
\end{wrapfigure}
Aby wys³aæ bota do gry (konkursu) nale¿y w pierwszej kolejno¶ci przej¶æ na stronê zawieraj±c± szczegó³owy opis gry. Mo¿na to zrobiæ klikaj±c na przycisk "Games list" ("Contests") znajduj±cy siê na górze strony, a nastêpnie 
wybraæ grê (konkurs) z wy¶wietlonej listy.

Gdy znajdujemy siê ju¿ na stronie z detalami nale¿y, w celu zg³oszenia bota, klikn±æ na link "Send bot for this game" (lub "Add contestant" w przypadku konkursu) i wype³niæ formularz wy¶wietlony przez system.
Podobnie, jak w przypadku tworzenia gry nale¿y mieæ uprzednio przygotowany plik zawieraj±cy kod ¼ród³owy bota. Bot komunikuje siê z sêdzi± za pomoc± komunikatów opisanych w zasadach gry wypisywanych i zczytywanych ze standatdowego 
wej¶cia i wyj¶cia. W przypadku, gdy bot wy¶le ¼le sformatowany lub b³êdny komunikat - automatycznie przegrywa rozgrywkê dostaj±c za ni± mo¿liwe minimum punktów.

\subsubsection{Dodanie komentarza pod gr± lub konkursem}
Aby dodaæ komentarz do gry (konkursu) nale¿y znaldowaæ siê na stronie ze szczegó³owym opisem danej gry (konkursu). Nastêpnie klikn±æ w link "Add comment" i wype³niæ formularz wy¶wietlony przez system.
Komunikat ten pojawi siê w kolejno¶ci odwrotnie chronologicznej pod opisem zasad gry.
\begin{wrapfigure}{l}{0.7\textwidth}
	\begin{center}
		\includegraphics[width=0.68\textwidth]{img/comment.png}
	\end{center}
	\caption{Komentarz umieszczony pod gr±}
\end{wrapfigure}


Nale¿y zwróciæ uwagê, i¿ w przypadku naruszania zasad publicznego wypowiadania siê (tre¶ci wulgarne, obra¼liwe, naruszaj±ce prywatno¶æ itp.) moderator konkursu ma prawo do edycji lub usuniêcia komentarza. 
Takie samo prawa ma równie¿ autor komentarza.

\subsubsection{Wy¶wietlenie kodu ¼ród³owego sêdziego}
\begin{wrapfigure}{l}{0.7\textwidth}
	\begin{center}
		\includegraphics[width=0.68\textwidth]{img/source_code.png}
	\end{center}
	\caption{Sposób wy¶wietlania kodu ¼ród³owego}
\end{wrapfigure}
W celu wy¶wietlenia kodu ¼ród³owego sêdziego nale¿y znajdowaæ siê na stronie gry zawiejaj±cej szczegó³owy jej opis. Potem, po klikniêciu w link "Show source of the judge" system przekieruje nas na stronê. gdzie wy¶wietlony zostanie 
kod ¼ród³owy sêdziego.

\Large{\subsection{Z udzia³em moderatora konkursu lub gry}}

\subsubsection{Usuniêcie komentarza do gry lub konkursu}
¯eby móc usun±æ komentarz u¿ytkownik musi spe³niaæ (minimum) jeden z poni¿szych warunków:
\begin{enumerate}
	\item{Byæ autorem komentarza}
	\item{Byæ moderatorem gry (konkursu), pod którym zosta³ ten komentarz dodany}
	\item{Byæ administratorem strony}
\end{enumerate}

Je¶li wymaganie wstêpne jest spe³nione, wystarczy klikn±æ w przycisk "Delete" znajduj±cy siê w prawym górnym rogu komentarza. Pojawi siê wtedy okienko z pro¶b± o potwierdzenie swojej decyzji.
Nale¿y pamiêtaæ, ¿e usuniêtego komentarza nie mo¿na przywróciæ! Wci¶niêcie przycisku "OK" na pojawiaj±cym siê okienku spowoduje usuniêcie komentarza i powrót do strony z detalami gry (konkursu)

\subsubsection{Edycja komentarza do gry lub konkursu}
Edycja komentarza jest podobna do dodawania nowego komentarza. Aby edytowaæ istniej±cy komentarz nale¿y klikn±æ w link "Edit" znajduj±cy siê w górnej czê¶ci komentarza. Pojawi siê wtedy 
formularz analogiczny do tego, który siê pojawia przy dodawaniu komentarza. Po zatwierdzeniu dokonywanych zmian poprzez naci¶niêcie przycisku "Save" zostaniemy przekierowani do strony ze szczegó³owymi informacjami o grze.
Zauwa¿my, ¿e edytowany komentarz jest ju¿ wy¶wietlany w zmienionej formie.

\subsubsection{Usuniêcie gry lub konkursu}
\begin{wrapfigure}{l}{0.5\textwidth}
	\begin{center}
		\includegraphics[width=0.48\textwidth]{img/delete_confirm.png}
	\end{center}
	\caption{Monit o potwierdzenie usuniêcia gry}
\end{wrapfigure}
Aby móc usun±æ grê (konkurs) trzeba spe³niaæ jeden z warunków:
\begin{enumerate}
	\item{Byæ moderatorem gry}
	\item{Byæ administratorem strony}
\end{enumerate}

W celu usuniêcia gry nale¿y znajdowaæ siê na stronie zawieraj±cej szczegó³owy opis gry. Nastêpnie klikn±æ w znajduj±cy siê po lewej stronie link "Delete this game". Spowoduje to wyskoczenie okienka z pro¶b± o potwierdzenie swojej 
decyzji. Pamiêtajmy, i¿ jest to decyzja nieodwracalna! Potwierdzenie wykonania operacji sposoduje usuniêcie gry z listy dostêpnych i przeniesienie na stronê g³ówn± serwisu.

\subsubsection{Edycja gry lub konkursu}
\begin{wrapfigure}{l}{0.5\textwidth}
	\begin{center}
		\includegraphics[width=0.48\textwidth]{img/game_options.png}
	\end{center}
	\caption{Sposób wy¶wietlania kodu ¼ród³owego}
\end{wrapfigure}
Mo¿liwa jest edycja konkursu. Aby tego dokonaæ trzeba byæ adnimistratorem lub moderatorem gry. Nale¿y klikn±æ w link "Edit game". 
System przeniesie nas do okna, w którym wy¶wietli siê formularz do edycji gry. Po wprowadzeniu zmian nale¿y zatwierdziæ przyciskiem "Save".

\chapter{Podsumowanie}

\chapter{Podzia³ prac}

\chapter{Spis p{\l}yty}

\appendix

\chapter{Przykladowe gry}

\section{Szachy}
    Znana na ca³ym ¶wiecie gra dwuosobowa, rozgrywana na kwadratowej planszy o 64 polach. Gracze wykonuj±
    naprzemienne posuniêcia figurami, a gra koñczy siê remisem, b±d¼ zwyciêstwem którego¶ z graczy.
    Gra jest ca³kowicie deterministyczna, ale jej z³o¿ono¶æ nie pozwoli³a dotychczas na znalezienie
    uniwersalnej strategii wygrywaj±cej, b±d¼ nieprzegrywaj±cej. Jednak obecne programy s± ju¿ od wielu
    lat w stanie wygraæ z najlepszymi graczami ludzkimi.

\section{Poker}
    Gra wieloosobowa, zawieraj±ca elementy hazardu. Rozgrywka zaczyna siê od losowego
    przydzia³u kart graczom, dlatego nie istnieje jedyna optymalna strategia grania.
    Celem gry jest zdobycie wszystkich punktów posiadanych przez innych graczy, które s± potrzebne,
    by uczestniczyæ w kolejnych rozdaniach. Istnieje wiele wariantów Pokera, najbardziej znanym
    jest tzw Texas Hold'em.

\section{Gra gie³dowa}
    Ka¿dy gracz ma pocz±tkowo okre¶lone fundusze. Nastêpnie inwestuje on w akcje dostêpne na gie³dzie.
    W zale¿no¶ci od inwestycji innych graczy, zmienia siê warto¶æ akcji, a co za tym idzie, dorobek
    ka¿dego z graczy. Celem jest oczywi¶cie powiêkszenie swojego kapita³u o jak najwiêksz± sumê,
    w kolejnych rundach.

\chapter{Przykladowe programy}

\chapter{Przebieg przykladowego turnieju}

\begin{thebibliography}{99}
\addcontentsline{toc}{chapter}{Bibliografia}
\end{thebibliography}

\end{document}
